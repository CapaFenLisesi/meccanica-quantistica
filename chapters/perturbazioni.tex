\chapter{Teoria delle perturbazioni}
Nel capitolo precedente abbiamo calcolato i livelli energetici dell'atomo di idrogeno.
Per quanto sia di grande importanza ``accademica'', però, sperimentalmente ha un interesse relativamente basso: per misurare queste energie, e in generale le proprietà del sistema, dobbiamo infatti farlo interagire con un agente esterno, tipicamente un campo elettromagnetico.
In generale lo studio dell'interazione tra materia e radiazione è molto importante, ma in questa trattazione troviamo molti problemi, come:
\begin{itemize}
	\item a rigore, tutto il sistema andrebbe quantizzato, ma il campo elettromagnetico ha un numero infinito di gradi di libertà;
	\item il campo elettromagnetico è invariante sotto ad un diverso gruppo di trasformazioni (quelle di Lorentz), che non abbiamo introdotto;
	\item anche introducendo le teorie relativistiche, dovremmo porre sullo stesso piano le quattro coordinate spaziotemporali, mentre finora il tempo è sempre stato un parametro e la posizione un operatore.
\end{itemize}
Dobbiamo quindi trovare un approccio più semplificato.
Se trattiamo il campo elettromagnetico in modo ``classico'', ad esempio, ci basterà aggiungere dei termini all'hamiltoniano.
Più in generale possiamo vedere quest'ultimo come composto da un termine $\op H_0$ che corrisponde al sistema isolato più un termine $\op H'$ che caratterizza la sua interazione con il campo,
\begin{equation}
	H=H_0+H'
	\label{eq:perturbazione}
\end{equation}
dove in generale $\op H'$ può anche dipendere esplicitamente dal tempo.
In quest'ottica possiamo vedere $\op H'$ come una \emph{perturbazione} del sistema isolato descritto da $\op H_0$.
Nel caso in cui $\op H'$ sia poi ``piccolo'' rispetto a $\op H_0$ possiamo poi analizzare il problema come si analizzerebbe un problema classico nell'ambito delle piccole oscillazioni.

Rimane però da capire cosa si intende con ``piccolo'': $\op H'$ è un operatore, non un numero, che in tutta generalità può anche essere illimitato.
Solitamente $\op H'$ e $\op H_0$ non sono compatibili, per cui non possiamo diagonalizzarli simultaneamente e confrontare gli autovalori.
Prendiamo una base $\{\ket{n}\}_{n\in\N}$ in cui $\op H_0$ è diagonale, e in questa base scriviamo la \eqref{eq:perturbazione} come
\begin{equation}
	\bra{n}\op H\ket{m}=H_{nm}=E_n\delta_{nm}+H'_{nm},
	\label{eq:perturbazione-base}
\end{equation}
dove $E_i$ sono gli autovalori di $\op H_0$.
Supponiamo ora che lo spazio degli stati sia bidimensionale, cos\`i da scrivere $\op H$ in forma matriciale:
\begin{equation}
	H=
	\begin{pmatrix}
		E_1+H'_{11}	&H'_{12}\\
		H'_{21}		&E_2+H'_{22}
	\end{pmatrix}.
\end{equation}
Dato che deve essere hermitiano, si ha $H'_{21}={H'_{12}}^*$ e $E_i+H'_{ii}\in\R$.
Il polinomio caratteristico è
\begin{multline}
	\chi_H(\lambda)=(E_1+H_{11}'-\lambda)(E_2+H'_{22}-\lambda)-\abs{H'_{12}}^2=\\
	=\lambda^2-(E_1+E_2+H'_{11}+H'_{22})\lambda+(E_1+H'_{11})(E_2+H'_{22})-\abs{H'_{12}}^2
	\label{eq:polinomio-caratteristico-H-perturbato-2d}
\end{multline}
da cui troviamo i due autovalori
\begin{equation}
	\begin{split}
		\lambda
		&=\frac12\bigg[E_1+E_2+H'_{11}+H'_{22}\pm\sqrt{(E_1+E_2+H'_{11}+H'_{22})^2-4(E_1+H'_{11})(E_2+H'_{22})+4\abs{H'_{12}}^2}\bigg]=\\
		&=\frac12\bigg[E_1+E_2+H'_{11}+H'_{22}\pm(E_1+H'_{11}-E_2-H'_{22})\sqrt{1+\frac{4\abs{H'_{12}}^2}{(E_1+H'_{11}-E_2-H'_{22})^2}}\bigg].
	\end{split}
	\label{eq:autovalori-H-perturbato-2d}
\end{equation}
Se $\abs{H'_{12}}^2\ll\abs{E_1+H'_{11}-E_2-H'_{22}}$ possiamo allora approssimare al primo ordine gli autovalori, in pratica trascurando la radice.
in tal caso, essi sono $E'_1\defeq E_1+H'_{11}$ e $E'_2\defeq E_2+H'_{22}$.
La condizione affinch\'e $\op H'$ sia piccolo può dunque essere formulata richedendo che gli elementi, in modulo, fuori dalla diagonale di esso siano molto minori della differenza $\abs{E'_1-E'_2}$.
Se inoltre $\abs{H'_{ii}}\ll\abs{E_i}$, allora $E'_i\approx E_i$, dunque la condizione può essere semplificata affermando che deve risultare
\begin{equation}
	\abs{H'_{ij}}\ll\abs{E_i-E_j},
	\label{eq:condizione-approssimazione-perturbazione-2d}
\end{equation}
potendo cos\`i usare i livelli energetici direttamente di $\op H_0$ anzich\'e di $\op H$ (i primi li conosciamo, se il sistema dato da $\op H_0$ è già noto, a differenza dei secondi).
Allora il valore di aspettazione di $\op H'$, calcolato sull'autostato imperturbato $\ket{E_i}$ di $\op H_0$, è proprio il termine da aggiungere al livello energetico corrispondente di $\op H_0$, che è l'autovalore in tale autostato.

\section{L'effetto Stark nell'atomo di idrogeno}
Consideriamo un sistema con un atomo di idrogeno posto in un campo elettrico costante nella direzione $z$ ($\vec E=\mathcal E\vec e_3$).
L'hamiltoniano del sistema è
\begin{equation}
	\op H=\op H_0+e\mathcal E\op x_3
	\label{eq:hamiltoniano-stark-idrogeno}
\end{equation}
dove $\op H_0$ è l'hamiltoniano, già visto, dell'atomo di idrogeno.
Nel sistema dell'atomo idrogeno isolato conosciamo le simmetrie, che portano alle degenerazioni con $n^2$ stati all'$n$-esimo livello di energia e $2l+1$ stati con momento angolare $l(l+1)\hbar^2$.
La perturbazione indotta da $\op H'$ potrebbe rimuovere alcune di queste degenerazioni, rompendo delle simmetrie.
Abbiamo infatti $[\op{\vec L},\op H_0]=0$, ma $[\op{\vec L},\op H']$ non è nullo: potremmo pensare inizialmente che, dato che $\op H'$ comprende il prodotto scalare $\scalar{\vec E}{\vec x}=\mathcal Ex_3$, esso commuti con $\op{\vec L}$, dato che i prodotti scalari sono invarianti per rotazioni dello spazio.
Ma tale momento angolare non è quello del sistema complessivo (formato dall'atomo e dal campo) ma solo dell'atomo, quindi esso genera solamente le rotazioni di quest'ultimo; poich\'e il campo ovviamente non ruota insieme all'atomo ma rimane fisso, non è invariante per questa rotazione, quindi $[\op{\vec L},\op H']\ne 0$.

L'elemento di matrice del termine $\op H'=e\mathcal E\op x_3$ è determinato da $\bra{n',l',m'}\op x_3\ket{n,l,m}$, dove $n,l,m$ sono i numeri quantici associati agli autovalori (per l'atomo di idrogeno imperturbato) rispettivamente di $\op H_0$, $\op{\vec L}^2$ e $\op L_3$.
Innanzitutto, ovviamente, risulta $\bra{n',l',m}\op x_3\ket{n,l,m}\leq\bra{n',l',m'}\op r\ket{n,l,m}$; trascurando per un attimo i numeri $l$ e $m$, dato che gli stati $\ket{n'}$ formano un insieme completo si ha
\begin{equation}
	\abs{\bra{n'}\op r\ket{n}}^2=\bra{n}\op r\ket{n'}\bra{n'}\op r\ket{n}\leq\sum_n\bra{n}\op r\ket{n'}\bra{n'}\op r\ket{n}=\bra{n}\op r^2\ket{n}
\end{equation}
ma allora
\begin{equation}
	\abs{\bra{n'}\op r\ket{n}}\leq\sqrt{\bra{n}\op r^2\ket{n}}=\sqrt{\frac12n^2[5n^2-3l(l+1)]}.
\end{equation}
Per grandi valori di $n$ dunque questo valore è asintotico a $n^2$, mentre se prendiamo stati con $n$ basso l'elemento di perturbazione sarà piccolo rispetto agli autovalori, e varrà la condizione \eqref{eq:condizione-approssimazione-perturbazione-2d}.\footnote{Ovviamente dovremo scegliere, nell'applicare la teoria, due livelli energetici differenti, altrimenti nella \eqref{eq:condizione-approssimazione-perturbazione-2d} troveremmo $\abs{E_n-E_n}=0$.}
Calcoliamo dunque gli elementi di matrice per i primi valori di $n$.

Per $n=1$ abbiamo lo stato fondamentale, che è simmetrico radialmente: allora, poich\'e non esistono direzioni ``privilegiate'', vediamo subito che $\bra{1,0,0}\op x_3\ket{1,0,0}=0$.
Al primo ordine, dunque, la perturbazione non influenza il sistema

Per $n=2$ abbiamo quattro stati, cioè l'insieme $\{\ket{2,0,0},\ket{2,1,0},\ket{2,1,-1},\ket{2,1,1}\}$ che prendiamo come base per calcolare i sedici elementi di matrice di $\op H'$.
Possiamo ridurre subito il numero di calcoli da fare notando che $\op H'$ è reale e hermitiano, perciò simmetrico.
Sempre per il discorso per cui non esistono direzioni privilegiate in stati a simmetria radiale, vale anche $\bra{2,0,0}\op x_3\ket{2,0,0}$.
Questo chiaramente vale per ogni componente di $\op{\vec x}$ in qualsiasi stato con $l=0$.
Detto $\ket{\psi}$ un tale stato, sarà combinazione lineare di stati del tipo $\ket{n,0,0}$, perch\'e se $l=0$ allora necessariamente $m=0$; quindi $\ket{\psi}=\sum_{n\in\N}a_n\ket{n,0,0}$.
Chiaramente vale $\op{\vec L}^2\ket{\psi}=0$: allora $\op x_i\ket{\psi}$ è ancora un suo autostato?
Poich\'e, come già visto, $\bra{\psi}\op x_i\ket{\psi}=0$, si ha che $\op x_i\ket{\psi}$ si trova in un sottospazio ortogonale a $\ket{\psi}$, in cui quindi $l\ne 0$.
Dopotutto, sappiamo che le tre armoniche sferiche con $l=1$ sono combinazioni lineari (linearmente indipendenti) di $x_1,x_2,x_3$ quindi possiamo, al contrario, scrivere $\op{\vec x}$ come combinazione lineare delle tre funzioni $Y_{1,0}$, $Y_{1,-1}$ e $Y_{1,1}$.
Allora $\op x_i\ket{n,0,0}$ è autostato di $\op{\vec L}^2$ con $l=1$.

Sappiamo inoltre che $\op H_0$ è invariante per parità, ossia $[\op H_0,\op I]=0$: allora i due operatori avranno autostati simultanei.
Infatti la parte radiale è simmetrica, e $\op I$ agisce soltanto sul fattore angolare della funzione d'onda come $\op IY_{l,m}=(-1)^lY_{l,m}$.
Di conseguenza abbiamo, dato che gli operatori $\op x_i$ sono dispari ossia $\adj{\op I}\op x_i\op I=-\op x_i$, che
\begin{equation}
	\bra{2,0,0}\op x_i\ket{2,0,0}=
	\bra{2,0,0}\op I^2\op x_i\op I^2\ket{2,0,0}=
	(-1)^{2l}\bra{2,0,0}\op I\op x_i\op I\ket{2,0,0}=
	-\bra{2,0,0}\op x_i\ket{2,0,0}
\end{equation}
da cui $\bra{2,0,0}\op x_i\ket{2,0,0}$, come ulteriore riprova.
Con lo stesso ragionamento troviamo che tra stati con uguale $l$ il valor medio di $\op x_i$ è nullo.

Ora, gli stati $\ket{2,0,0}$ e $\ket{2,1,0}$ hanno valori di $l$ differenti, e in particolare il secondo contiene nella funzione d'onda il termine $e^{i\phi}$, che integrato in $\phi$ dà zero.
Più in generale, per $n,l$ qualsiasi, $\op x_3\ket{m}$ è ancora autostato di $\op L_3$ (ma non necessariamente uguale, ma con lo stesso autovalore), poich\'e $[\op L_3,\op x_3]=0$.
Se $m_1\ne m_2$ allora si ha necessariamente che $\bra{2,1,m_1}\op x_3\ket{2,1,m_2}=0$ e in modo simile per gli altri stati.

Riassumendo, abbiamo trovato che alcune transizioni tra autostati sono proibite: abbiamo delle \emph{regole di selezione} con gli operatori $\op{\vec L}^2$, $\op L_3$ e $\op I$ che ci permettono di semplificare in modo veloce gli elementi di matrice di $\op H'$.
Rimane, infine, soltanto l'elemento $\bra{2,0,0}\op x_3\ket{2,1,0}$, che (insieme al suo simmetrico) è l'unico non nullo e vale $3r_B$.
Di conseguenza, la matrice che rappresenta l'hamiltoniano perturbato dal campo elettrico in questo sottospazio con $n=2$ è
\begin{equation}
	\begin{pmatrix}
		E_2				&3r_B\mathcal E	&0		&0	\\
		3r_B\mathcal E	&E_2			&0		&0	\\
		0				&0				&E_2	&0	\\
		0				&0				&0		&E_2\\
	\end{pmatrix}
\end{equation}
che ha come autovalori $E_2$, doppio (evidentemente per gli stati $\ket{2,1,1}$ e $\ket{2,1,-1}$), e $E_2\pm 3r_B\mathcal E$ per gli stati $\frac{\ket{2,0,0}\pm\ket{2,1,0}}{\sqrt{2}}$.
Quelli che prima erano quattro stati nello stesso livello (degenere) di energia per effetto della perturbazione ora formano tre livelli distinti.
La perturbazione, quindi, al primo ordine causa la rottura della degenerazione del livello di energia, per momenti angolari differenti con $m=0$.

\section{Perturbazioni indipendenti dal tempo}
\subsection{Caso non degenere}
Passiamo ora ad un approccio più generale, con un sistema descritto da un'hamiltoniano $\op H^{(0)}$ non degenere, di cui conosciamo lo spettro $\{E^{(0)}_n\}$, a cui è aggiunta una perturbazione $\op V$, nessuno dei due dipendente esplicitamente dal tempo.
Preso l'insieme (che è completo) degli autostati $\ket{\psi_n}$ di $\op H^{(0)}$, possiamo esprimere uno stato perturbato $\ket{\tilde{\psi}_n}$ qualsiasi in tale base come
\begin{equation}
	\ket{\tilde{\psi}_n}=\sum_mc_{nm}\ket{\psi_m}
\end{equation}
per cui l'equazione di Schr\"odinger (con l'hamiltoniano perturbato) $\op H\ket{\tilde{\psi}_n}=E_n\ket{\tilde{\psi}_n}$ si scrive come
\begin{equation}
	\sum_mc_{nm}(\op H^{(0)}+\op V)\ket{\psi_m}=\sum_mc_{nm}E_n\ket{\psi_m}
\end{equation}
e poich\'e $\op H^{(0)}\ket{\psi_m}=E^{(0)}_m\ket{\psi_m}$, moltiplicando a sinistra per $\bra{\psi_k}$ otteniamo
\begin{equation}
	\begin{aligned}
		\sum_mc_{nm}(E^{(0)}_m\braket{\psi_k}{\psi_m}+\bra{\psi_k}\op V\ket{\psi_m})&=\sum_mc_{nm}E_n\braket{\psi_k}{\psi_m}\\
		\sum_mc_{nm}(E^{(0)}_m\delta_{km}+V_{km})&=\sum_mc_{nm}E_n\delta_{km}\\
		c_{nk}E^{(0)}_k+\sum_mc_{nm}V_{km}&=c_{nk}E_n\\
		c_{nk}(E_n-E^{(0)}_k)&=\sum_mc_{nm}V_{km}
	\end{aligned}
	\label{eq:perturbazione-non-degenere}
\end{equation}
definendo $V_{km}\defeq\bra{\psi_k}\op V\ket{\psi_n}$.
Immaginiamo ora di poter sviluppare i termini della perturbazione in serie come
\begin{equation}
	\begin{gathered}
		c_{ij}=c^{(0)}_{ij}+c^{(1)}_{ij}+\cdots\\
		E_{i}=E^{(0)}_i+E^{(1)}_i+\cdots
	\end{gathered}
\end{equation}
dove $E^{(0)}_i$ sono proprio gli autovalori di $\op H^{(0)}$ (questo giustifica la notazione usata).
Poich\'e, all'ordine zero, la perturbazione deve lasciare invariato il sistema, si deve avere $\sum_mc_{nm}\ket{\psi_m}=\ket{\psi_n}$ perciò
\begin{equation}
	c^{(0)}_{ij}=\delta_{ij}.
	\label{eq:zero-ordine-perturbazione-non-degenere}
\end{equation}
Al primo ordine, invece, risulta dalla \eqref{eq:perturbazione-non-degenere} che
\begin{equation}
	(\delta_{nk}+c^{(1)}_{nk})(E^{(0)}_n-E^{(0)}_k+E^{(1)}_n)=V_{kn}\\
\end{equation}
e per $n=k$ si ha $E^{(1)}_n=V_{nn}$, mentre se $k\ne n$
\begin{equation}
	c^{(1)}_{nk}(E^{(0)}_n-E^{(0)}_k)=V_{kn}
\end{equation}
ossia, come avevamo già trovato all'inizio del capitolo nel caso bidimensionale,
\begin{equation}
	c^{(1)}_{nk}=\frac{V_{kn}}{E^{(0)}_k-E^{(0)}_n}.
	\label{eq:primo-ordine-perturbazione-non-degenere}
\end{equation}
La non degenerazione di $\op H^{(0)}$ assicura che $E^{(0)}_k\ne E^{(0)}_n$ quando $k\ne n$.

\section{Perturbazioni dipendenti dal tempo}
Considieriamo ora un hamiltoniano $\op H(t)=\op H^{(0)}+\op V(t)$, con $\op H^{(0)}$ indipendente (esplicitamente) dal tempo.
Supponiamo di avere uno stato stazionario $\ket{E_i^{(0)}}$ presente da un tempo molto remoto (anche $t=-\infty$) e che la perturbazione $\op V(t)$ si «attivi» ad un certo istante $t_0$.
Siamo interessati a calcolare la probabilità che il sistema si trovi in un autostato (fissato) $\ket{E_f^{(0)}}$ di $\op H^{(0)}$ per effetto della perturbazione: anche se due autostati di $\op H^{(0)}$ sono ortogonali, per cui si avrebbe una probabilità di transizione tra i due nulla, per effetto di $\op V(t)$ essi non sono più stazionari quindi anche le loro probabilità cambiano nel tempo, e non si possono più considerare a priori ortogonali.
Dovremo quindi caratterizzare l'evoluzione temporale dello stato $\ket{E_i^{(0)}}$ per effetto di $\op H(t)$: chiamando lo stato progredito $\ket{E_i(t)}$, la probabilità di passare dallo stato iniziale a quello finale che abbiamo fissato è, istante per istante, data da $\abs{\braket{E_i(t)}{E_f}}^2$.
All'hamiltoniano $\op H^{(0)}$, indipendente dal tempo, possiamo associare l'operatore di evoluzione temporale
\begin{equation}
	\op U_0(t,t_0)=\exp\bigg(-\frac{i}{\hbar}(t-t_0)\op H^{(0)}\bigg)
\end{equation}
Ci affidiamo dunque al postulato secondo il quale gli stati evolvono secondo l'equazione differenziale\footnote{Naturalmente anche $\op U_0(t,t_0)$ soddisfa quest'equazione, con $\op H^{(0)}$ al posto di $\op H(t)$, se poniamo la naturale condizione al contorno $U_0(t_0,t_0)=1$; per sistemi indipendenti dal tempo è equivalente assumere come postulato l'equazione differenziale o direttamente l'espressione dell'operatore.}
\begin{equation}
	i\hbar\drp{}{t}\ket{E_i(t)}=\op H(t)\ket{E_i(t)}.
	\label{eq:evouzione-temporale-autostato-iniziale}
\end{equation}
Cerchiamo di trovare, stavolta con delle inevitabili approssimazioni, un operatore $\op U(t,t_0)$ che descriva l'evoluzione del sistema nel tempo, ossia in questo caso tale che $\op U(t,t_0)\ket{E_i(t_0)}=\ket{E_i(t)}$ (in cui $\ket{E_i(t_0)}$ è ancora lo stato iniziale, cioè è proprio $\ket{E_i^{(0)}}$).
Per la \eqref{eq:evouzione-temporale-autostato-iniziale} tale operatore dovrà quindi soddisfare l'equazione
\begin{equation}
	i\hbar\drp{\op U(t,t_0)}{t}=\op H(t)\op U(t,t_0).
\end{equation}
La probabilità di transizione tra i due stati è dunque
\begin{equation}
	P_{fi}=\abs{\braket{E_f^{(0)}}{E_i(t)}}^2=\abs{\bra{E_f^{(0)}}\op U(t,t_0)\ket{E_i^{(0)}}}^2=\abs{\bra{E_f^{(0)}}\adj{\op U_0}(t,t_0)\op U(t,t_0)\ket{E_i^{(0)}}}^2
\end{equation}
poich\'e $\op U_0(t,t_0)\ket{E_f^{(0)}}=e^i\phi(t)\ket{E_f^{(0)}}$, essendo un autostato di $\op H^{(0)}$, e la fase non influisce sul modulo, quindi sulla probabilità di transizione.

\paragraph{Rappresentazione di interazione}
Definiamo a questo punto l'operatore
\begin{equation}
	\op{\mathbb U}(t,t_0)\defeq\adj{\op U_0}(t,t_0)\op U(t,t_0).
\end{equation}
Ora, per studiare l'evoluzione temporale degli stati o degli operatori, anzich\'e adottare lo schema di Heisenberg o di Schr\"odinger è conveniente usare la cosiddetta \emph{rappresentazione di interazione}, nella quale gli stati evolvono con l'operatore $\op{\mathbb U}$ mentre le osservabili con l'operatore $\op U_0$.
Ad esempio, presa un'osservabile $\xi$, il suo valor medio nel tempo è
\begin{equation}
	\avg{\xi(t)}=
	\bra{\psi(t)}\op\xi\ket{\psi(t)}=
	\bra{\psi}\adj{\op U}(t)\op\xi\op U(t)\ket{\psi}=
	\bra{\psi}\adj{\op{\mathbb U}}\adj{\op U_0}\op\xi\op U_0\op{\mathbb U}\ket{\psi}
	\label{eq:esempio-rappresentazione-interazione}
\end{equation}
per cui è utile assumere $\ket{\psi(t)}=\op{\mathbb U}(t,t_0)\ket{\psi(t_0)}$ e $\op\xi(t)=\adj{\op U}(t,t_0)\op\xi(t_0)\op U(t,t_0)$.

La derivata temporale dell'operatore $\op{\mathbb U}$ è inoltre
\begin{multline}
	\drp{}{t}\op{\mathbb U}=\drp{}{t}(\adj{\op U_0}\op U)=\drp{\adj{\op U_0}}{t}\op U+\adj{\op U_0}\drp{\op U}{t}=\frac{i}{\hbar}\adj{\op U_0}\op H^{(0)}\op U+\adj{\op U_0}\bigg(-\frac{i}{\hbar}\op H\op U\bigg)=\\=
	-\frac{i}{\hbar}\adj{\op U_0}(-\op H^{(0)}+\op H)\op U=-\frac{i}{\hbar}\adj{\op U_0}\op V\op U=-\frac{i}{\hbar}\adj{\op U_0}\op V\op U_0\op U.
\end{multline}
Chiamando dunque $\op{\mathbb V}\defeq\adj{\op U_0}\op V\op U_0$ abbiamo dunque l'equazione
\begin{equation}
	i\hbar\drp{\op{\mathbb U}}{t}=\op{\mathbb V}\op{\mathbb U}.
	\label{eq:evoluzione-temporale-perturbazione-dipendende-tempo}
\end{equation}
Notiamo che se $\op V=0$ ritroviamo correttamente che il sistema è stazionario.

